<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE beans PUBLIC '-//SPRING//DTD BEAN//EN' 'http://www.springframework.org/dtd/spring-beans.dtd'>

<beans>
    <!--The initial openESDH folder context-->
    <bean id="${project.artifactId}_bootstrap" parent="spacesStoreImporter">
        <property name="log">
            <value>false</value>
        </property>
        <property name="useExistingStore">
            <value>true</value>
        </property>
        <property name="transactionService" ref="transactionService"/>
        <property name="bootstrapViews">
            <list>
                <props>
                    <prop key="path">app:company_home</prop>
                    <!--<prop key="uuidBinding">REPLACE_EXISTING</prop>-->
                    <prop key="uuidBinding">UPDATE_EXISTING</prop>
                    <prop key="location">alfresco/module/${project.artifactId}/context/bootstrap/folders.xml</prop>
                </props>
                <props>
                    <prop key="path">app:company_home/oe:OpenESDH/oe:subsystems/oe:officeTemplates</prop>
                    <prop key="uuidBinding">UPDATE_EXISTING</prop>
                    <prop key="childAssocType">rule:ruleFolder</prop>
                    <prop key="location">alfresco/module/${project.artifactId}/context/bootstrap/templateRuleFolder.xml</prop>
                </props>
            </list>
        </property>
    </bean>
    <!-- initial document types -->
    <bean id="${project.artifactId}_docTypesBootstrap" parent="spacesStoreImporter">
        <property name="log">
            <value>true</value>
        </property>
        <property name="useExistingStore">
            <value>true</value>
        </property>
        <property name="transactionService" ref="transactionService"/>
        <property name="bootstrapViews">
            <list>
                <props>
                    <prop key="path">app:company_home/oe:OpenESDH/oe:classifications/oe:document_types</prop>
                    <prop key="uuidBinding">UPDATE_EXISTING</prop>
                    <prop key="location">alfresco/module/${project.artifactId}/context/bootstrap/documentTypes.xml
                    </prop>
                </props>
            </list>
        </property>
    </bean>
    <!-- initial document categories -->
    <bean id="${project.artifactId}_docCategBootstrap" parent="spacesStoreImporter">
        <property name="log">
            <value>true</value>
        </property>
        <property name="useExistingStore">
            <value>true</value>
        </property>
        <property name="transactionService" ref="transactionService"/>
        <property name="bootstrapViews">
            <list>
                <props>
                    <prop key="path">app:company_home/oe:OpenESDH/oe:classifications/oe:document_categories</prop>
                    <prop key="uuidBinding">UPDATE_EXISTING</prop>
                    <prop key="location">
                        alfresco/module/${project.artifactId}/context/bootstrap/documentCategories.xml
                    </prop>
                </props>
            </list>
        </property>
    </bean>
    <!--Contacts store-->
    <bean id="${project.artifactId}_contactBootstrap" parent="spacesStoreImporter">
        <property name="log">
            <value>false</value>
        </property>
        <property name="useExistingStore">
            <value>true</value>
        </property>
        <property name="transactionService" ref="transactionService"/>

        <property name="bootstrapViews">
            <list>
                <props>
                    <prop key="path">sys:system</prop>
                    <prop key="uuidBinding">UPDATE_EXISTING</prop>
                    <prop key="location">alfresco/module/${project.artifactId}/context/bootstrap/contacts.xml</prop>
                </props>
            </list>
        </property>
    </bean>

    <bean id="${project.artifactId}_activitiesEmailBootstrap" parent="spacesStoreImporter" >
        <property name="log"> 
            <value>false</value> 
        </property>
        <property name="useExistingStore"> 
            <value>true</value> 
        </property>
        <property name="transactionService" ref="transactionService"/>

        <property name="bootstrapViews">
            <list>
                <props>
                    <prop key="path">/app:company_home/app:dictionary/app:email_templates</prop>
                    <prop key="uuidBinding">UPDATE_EXISTING</prop>
                    <prop key="location">alfresco/module/${project.artifactId}/context/bootstrap/activities-email-templates.xml</prop>
                </props>
            </list>
        </property>
    </bean>
    
    <bean id="${project.artifactId}_permissionModelBootstrap" parent="permissionModelBootstrap">
        <property name="model" value="alfresco/module/openesdh-repo/models/permission-model-extension.xml"/>
    </bean>

    <bean id="${project.artifactId}_workflowBootstrap" parent="workflowDeployer">
        <property name="workflowDefinitions">
            <list>
                <props>
                    <prop key="engineId">activiti</prop>
                    <prop key="location">alfresco/module/${project.artifactId}/workflows/sequentialReview.bpmn</prop>
                    <prop key="mimetype">text/xml</prop>
                    <prop key="redeploy">false</prop>
                </props>
            </list>
        </property>
        <property name="labels">
            <list>
                <value>alfresco/module/${project.artifactId}/messages/workflow-messages</value>
            </list>
        </property>
    </bean>
    <bean id="patch.siteLoadPatch.opene" class="org.alfresco.repo.admin.patch.impl.SiteLoadPatch" parent="basePatch">
        <property name="id"><value>patch.siteLoadPatch.opene</value></property>
        <property name="description"><value>patch.siteLoadPatch.description</value></property>
        <property name="fixesFromSchema"><value>0</value></property>
        <property name="fixesToSchema"><value>${version.schema}</value></property>
        <property name="targetSchema"><value>10000</value></property>
        <property name="spacesBootstrap" ref="siteLoadBootstrap-Spaces" />
        <property name="usersBootstrap" ref="siteLoadBootstrap-Users" />
        <property name="siteService" ref="siteService" />
        <property name="descriptorService" ref="descriptorComponent" />
        <property name="authorityService" ref="authorityService" />
        <property name="behaviourFilter" ref="policyBehaviourFilter" />
        <property name="siteName">
            <value>opene</value>
        </property>
        <property name="bootstrapViews">
            <map>
                <entry key="contents">
                    <props>
                        <prop key="path">app:company_home/st:sites</prop>
                        <prop key="location">alfresco/module/${project.artifactId}/context/bootstrap/sites.xml</prop>
                    </props>
                </entry>
            </map>
        </property>
    </bean>
</beans>
